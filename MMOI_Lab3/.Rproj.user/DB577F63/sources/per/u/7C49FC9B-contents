library(GGally)
library(corrr)


#------------------------------------------------------1
df<-read.csv("dataset_3.csv", stringsAsFactors = TRUE)
ggpairs(df[,c(5, 7)])
#------------------------------------------------------2
model<-lm(df[,c(5)]~df[,c(7)])
model
#------------------------------------------------------3
plot(df[,c(5, 7)])
abline(model, col = "blue")
#------------------------------------------------------4
plot(df[,c(5)] ~ fitted(model), xlab = "Прогнозовані моделлю значення", ylab = "Значення спостережень", main = "Діаграма \"відгук-прогноз\" ")
abline(0, 1)
#------------------------------------------------------5
plot(resid(model) ~ fitted(model), xlab = "Прогнозовані моделлю значення", ylab = "Залишки моделі", main = "Діаграма \"прогноз-залишки\" ")
abline(h = 0)
#------------------------------------------------------6
plot(c(1:length(df[,c(5)])), resid(model), xlab = "Порядковий номер", ylab = "Значення залишків", main = "Значення залишків за порядковим номером")
abline(h = 0)
#------------------------------------------------------7
qqnorm(resid(model), main = "Q-Q-діаграма для залишків моделі", xlab = "Теоретичні квантилі", ylab = "Емпіричні квантилі")
qqline(resid(model))